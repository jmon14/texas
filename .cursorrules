# Texas Poker Application – Cursor Rules

These rules apply to AI assistants working inside Cursor on the Texas poker project.

---

## 1. Orchestrator & Phase Awareness

- Treat `.claude/CLAUDE.md` as the authoritative machine contract.
- For any non-trivial feature, bugfix, or refactor:
  - First look for a relevant phase file in `.claude/phases/`.
  - If found, read the phase file and work **strictly within** its scope (Overview, Context, AgentPlan, Tasks).
  - If no relevant phase file exists, behave as a normal code assistant and do **not** invent new phases or tasks unless the user explicitly asks for planning.
- When the user mentions:
  - "phase X", or a specific phase file → load that file and use its AgentPlan/Tasks.
  - a specific agent (backend, frontend, devops, tests, docs) → load the corresponding agent file from `.claude/agents/` and follow its template and constraints.

---

## 2. MCP Usage

- Only use MCP tools when they add value to the current request. Avoid noisy or redundant calls.
- ClickUp:
  - Do **not** query ClickUp from Cursor unless the user explicitly asks to sync or inspect tickets.
  - Planning from ClickUp → phases is primarily handled in Claude Code, not in Cursor.
- Texas MCP tools:
  - Prefer reading project state and searching the repo through MCP tools instead of guessing.
  - Use tools (if available) to:
    - read phase files
    - read agent definitions
    - search code
    - run tests
  - Do **not** create or restructure phases/tasks via MCP unless the user explicitly requests planning.
- You do **not** need to call `get_user_preferences` or `plan_task_with_agents` automatically for every request. Use them only when the user explicitly asks for planning or workflow setup.

---

## 3. Documentation References

Follow this order when you need context:

1. Phase file: `.claude/phases/*.md` (scope, requirements, AgentPlan, Tasks)
2. Agent definitions: `.claude/agents/*.md` (role-specific behavior)
3. Project-level docs:
   - `CONTRIBUTING.md` (workflow, style, testing)
   - `docs/architecture.md`
   - `README.md`
   - `docs/troubleshooting.md`
   - `infrastructure/README.md`
   - `CHANGELOG.md`
4. Service docs:
   - `apps/backend/README.md`
   - `apps/frontend/README.md`
5. Tool docs:
   - `tools/texas-mcp-server/README.md`
   - `tools/clickup-mcp-server/README.md`

Do **not** invent new patterns that conflict with these documents.

---

## 4. Agentic Coding Behavior

- When implementing work that clearly belongs to a domain:
  - Backend → follow `backend-architect` agent file.
  - Frontend → follow `frontend-developer` agent file.
  - Infra/CI/CD → follow `devops-engineer`.
  - Tests → follow `test-automator`.
  - Docs → follow `documentation-expert`.
- For cross-domain work, follow this order:
  1. backend
  2. frontend
  3. tests
  4. docs
- Respect constraints from `.claude/CLAUDE.md` and the agent templates:
  - Only use tools and modify files within the agent's domain.
  - Produce minimal, targeted diffs.
  - Avoid unsolicited refactors or architecture changes.

---

## 5. Coding & Testing Principles

- Follow project style and rules from `CONTRIBUTING.md`:
  - TypeScript strict mode.
  - Existing linting/formatting conventions (e.g. single quotes, async/await patterns).
- All meaningful changes should include or update tests.
- Significant API changes must also update:
  - relevant docs,
  - OpenAPI/specs (if present),
  - and the CHANGELOG where appropriate.

---

## 6. Scope & Safety

- Respect phase scope:
  - Only modify code that is explicitly listed or clearly implied by the active phase's Tasks/AgentPlan.
  - Update corresponding tests and docs, but do **not** touch unrelated services or code.
- Do **not** modify:
  - `.claude/CLAUDE.md`
  - `.claude/templates/*`
  - `.claude/agents/*.md`
  - unless the user explicitly asks to change templates or the orchestration system.
- NEVER commit, push, or run destructive commands (e.g. `rm -rf`, dropping DBs) unless the user explicitly requests it and understands the consequences.
